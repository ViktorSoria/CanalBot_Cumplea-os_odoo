<?xml version="1.0" encoding="UTF-8" ?>
<templates id="template" xml:space="preserve">
    <t t-name="ActionpadWidgetControl" t-inherit="point_of_sale.ActionpadWidget" t-inherit-mode="extension" owl="1">
        <xpath expr="//button[hasclass('pay')]" position="replace">
            <button class="button pay" t-on-click="trigger('click-pay')" t-att-disabled="!userpay"
                    t-att-class="{'disabled-mode': !userpay}">
                <div class="pay-circle">
                    <i class="fa fa-chevron-right" role="img" aria-label="Pay" title="Pay"/>
                </div>
                Pagos
            </button>
        </xpath>
    </t>
    <t t-name="SendOrder" owl="1">
        <div class="ticket-button" t-on-click="onClick">
            <i class="fa fa-send"/>
            Enviar Pedido
        </div>
    </t>
    <t t-name="ResOrder" owl="1">
        <div class="ticket-button" t-on-click="onClick">
            <i class="fa fa-get-pocket"/>
        </div>
    </t>
    <t t-name="Chrome" t-inherit="point_of_sale.Chrome" t-inherit-mode="extension" owl="1">
        <xpath expr="//div[hasclass('pos-branding')]" position="inside">
            <ResOrder/>
            <SendOrder/>
        </xpath>
    </t>

    <t t-name="PaymentMethodButton" t-inherit="point_of_sale.PaymentMethodButton" t-inherit-mode="extension" owl="1">
        <xpath expr="//div[hasclass('payment-name')]" position="inside">
            <t t-if="props.paymentMethod.cargo &gt; 0">
                <t t-esc="' + '+props.paymentMethod.cargo+ '%'"/>
            </t>
        </xpath>
    </t>

    <t t-name="PaymentScreenPaymentLines" t-inherit="point_of_sale.PaymentScreenPaymentLines" t-inherit-mode="extension"
       owl="1">
        <xpath expr="//div[@t-att-class='selectedLineClass(line)']/div" position="inside">
            <t t-if="line.payment_method.cargo &gt; 0">
                <t t-esc="' + '+line.payment_method.cargo+ '%'"/>
            </t>
        </xpath>
        <xpath expr="//div[@t-att-class='unselectedLineClass(line)']/div" position="inside">
            <t t-if="line.payment_method.cargo &gt; 0">
                <t t-esc="' + '+line.payment_method.cargo+ '%'"/>
            </t>
        </xpath>
    </t>

    <t t-name="PaymentScreen" t-inherit="point_of_sale.PaymentScreen" t-inherit-mode="extension">
        <xpath expr="//t[@t-foreach='payment_methods_from_config']" position="replace">
            <t t-foreach="payment_methods_from_config" t-as="paymentMethod"
               t-key="paymentMethod.id">
                <t t-if="!paymentMethod.es_puntos">
                    <PaymentMethodButton paymentMethod="paymentMethod"/>
                </t>
            </t>
        </xpath>
        <xpath expr="//div[@class='customer-button']" position="before">
            <t t-if="puntos">
                <div class="button" style="margin-bottom: 10px;" t-on-click="pay_electronic">
                    <i class="fa fa-money" role="img"/>
                    <span t-esc="'Puntos: '+puntos"/>
                </div>
            </t>
        </xpath>
        <xpath expr="//div[@class='payment-controls']" position="after">
            <t t-if="currentOrder.is_to_invoice()">
                <div class="text-center" style="margin-top:10px;">
                    <select name="property_product_pricelist" style="width:270px;height:50px" id="method">
                        <option value="G03">Gastos en general</option>
                        <option value="G01">Adquisición de mercancías</option>
                        <option value="G02">Devoluciones, descuentos o bonificaciones</option>
                        <option value="I05">Dados, troqueles, moldes, matrices y herramental</option>
                        <option value="I08">Otra maquinaria y equipo</option>
                        <option value="P01">Por definir</option>
                    </select>
                </div>
            </t>
        </xpath>
    </t>

    <t t-name="Buttonsend" owl="1">
       <div role="dialog" class="modal-dialog">
           <div class="popup">
                <div class="title">
                   <p><t t-esc="props.title"/></p>
                    <input type="text" t-model="state.name" t-ref="session" disabled="1"
                           style="box-shadow: 0px 0px 0px 3px #6EC89B;"/>
               </div>
               <div class="body" style="overflow: auto; height: 250px;">
                   <div class="row">
                       <t t-foreach="props.sessions" t-as="s" t-key="props.sessions">
                           <div class="session-dis" t-att-session-id="s.id" t-on-click="selection"
                                t-att-sname="s.config_id[1]">
                               <i class="fa fa-desktop" style="font-size: 300%" t-att-session-id="s.id"
                                  t-att-sname="s.config_id[1]"/>
                               <hr/>
                               <t t-esc="s.config_id[1]" t-att-session-id="s.id" t-att-sname="s.config_id[1]"/>
                           </div>
                       </t>
                   </div>
               </div>
               <div class="footer">
                   <div class="button" t-on-click="confirm">
                       <t t-esc="props.confirmText"/>
                   </div>

                   <div class="button" t-on-click="confirmAndPrint">
                       <t t-esc="props.printConfirmText"/>
                   </div>

                   <div class="button cancel" t-on-click="cancel">
                       <t t-esc="props.cancelText"/>
                   </div>
               </div>
           </div>
       </div>
   </t>
    <t t-name="Buttonreceive" owl="1">
        <div role="dialog" class="modal-dialog">
           <div class="popup">
                <p class="title">
                   <t t-esc="props.title"/>
                    <br/>
                </p>
               <div class="body" style="overflow: auto; height: 250px;">
                   <table class="table">
                       <tr>
                           <th>No.</th>
                           <th>Pedido</th>
                           <th>Punto de Venta</th>
                           <th>Vendedor</th>
                       </tr>
                       <t t-set="i" t-value="1"/>
                       <t t-foreach="props.orders" t-as="o">
                           <tr class="tam" t-att-order-id="o.id" t-on-click="selection" t-att-sname="o.pos_name">
                               <td t-esc="i"/>
                               <td t-esc="o.orden"/>
                               <td t-esc="o.pos_name"/>
                               <td t-esc="o.cajero"/>
                           </tr>
                           <t t-set="i" t-value="i+1"/>
                       </t>
                   </table>
               </div>
               <div class="footer">
                   <div class="button" t-on-click="GetOrder">
                       <t t-esc="props.confirmText"/>
                   </div>

                   <div class="button cancel" t-on-click="cancel">
                       <t t-esc="props.cancelText"/>
                   </div>
                </div>
            </div>
        </div>
    </t>

    <t t-name="OrderReceipt" t-inherit="point_of_sale.OrderReceipt" t-inherit-mode="extension" owl="1">
        <xpath expr="//t[@t-if='receipt.cashier']" position="after">
            <div class="cashier" t-if="cliente">
                <div>Para <t t-esc="cliente.name"/></div>
            </div>
        </xpath>
        <xpath expr="//div[@class='pos-receipt-order-data']" position="after">
            <br/>
            <div class="pos-receipt-order-data">
                <div><t t-esc="ubicacion[0]" /></div>
                <div><t t-esc="ubicacion[1]" /></div>
                <div><t t-esc="ubicacion[2]" /></div>
            </div>
            <t t-if="cfdi_vals">
                <br/>
                <div class="pos-receipt-order-data">
                    <div t-if="cfdi_vals.sello" class="barcode">
                        <img alt="Barcode" t-att-src="cfdi_vals.qr"/>
                    </div>
                    <div class="complement-details">
                        <div class="digital-stamp text-center">
                            <strong>Sello digital del emisor</strong>
                        </div>
                        <div class="digital-stamp-content">
                            <span t-esc="cfdi_vals.sello"/>
                        </div>
                        <div class="digital-stamp text-center">
                            <strong>Sello digital SAT</strong>
                        </div>
                        <div class="digital-stamp-content">
                            <span t-esc="cfdi_vals.sello_sat"/>
                        </div>
                        <div class="digital-stamp text-center">
                            <strong>Complemento de cadena original de certificación digital SAT</strong>
                        </div>
                        <div class="digital-stamp-content">
                            <span class="nowrap" t-esc="cfdi_vals.cadena"/>
                        </div>
                        <div class="digital-stamp text-center">
                            <strong>Informacion Extra</strong>
                        </div>
                        <div class="digital-stamp-content">
                            <span>Certificado del Emisor:</span>
                            <span t-esc="cfdi_vals.certificate_number"/>
                            <span> | Certificado del Sat:</span>
                            <span t-esc="cfdi_vals.certificate_sat_number"/>
                            <span> | Lugar de Expedición:</span>
                            <span t-esc="cfdi_vals.expedition"/>
                            <span> | Regimen Fiscal:</span>
                            <span t-esc="cfdi_vals.fiscal_regime"/>
                            <span> | Fecha de Emisión:</span>
                            <span t-esc="cfdi_vals.emission_date_str"/>
                            <span> | Fecha de certificación:</span>
                            <span t-esc="cfdi_vals.stamp_date"/>
                            <span> | Folio Fiscal:</span>
                            <span t-esc="cfdi_vals.uuid"/>
                        </div>
                        <div class="digital-stamp-content text-center">
                            <strong>Este documento es una representación impresa de un CFDI</strong>
                        </div>
                    </div>
                </div>
            </t>
        </xpath>
        <xpath expr="//t[@t-if='receipt.total_discount']" position="after">
            <div t-if="puntos">
                Puntos Acomulados:
                <span t-esc="puntos" class="pos-receipt-right-align"/>
            </div>
        </xpath>
        <xpath expr="//t[@t-if='isTaxIncluded']" position="replace">
            <div>
                Total de Impuestos
                <span t-esc="env.pos.format_currency(receipt.total_tax)" class="pos-receipt-right-align"/>
            </div>
        </xpath>
        <xpath expr="//div[hasclass('orderlines')]" position="replace">
            <div class="orderlines">
                <t t-foreach="receipt.orderlines" t-as="line" t-key="line.id">
                    <!--<t t-if="isSimple(line)">
                        <div>
                            <t t-esc="line.product_name_wrapped[0]" />
                            <span t-esc="env.pos.format_currency_no_symbol(line.price_display)" class="price_display pos-receipt-right-align"/>
                        </div>
                        <WrappedProductNameLines line="line" />
                    </t>-->
                    <!--<t t-else="">-->
                    <div t-esc="line.product_name_wrapped[0]"/>
                    <WrappedProductNameLines line="line"/>
                    <t t-if="line.display_discount_policy == 'without_discount' and line.price != line.price_lst">
                            <div class="pos-receipt-left-padding">
                                <t t-esc="env.pos.format_currency_no_symbol(line.price_lst)"/>
                                ->
                                <t t-esc="env.pos.format_currency_no_symbol(line.price)"/>
                            </div>
                        </t>
                    <t t-elif="line.discount !== 0">
                            <div class="pos-receipt-left-padding">
                                <t t-if="env.pos.config.iface_tax_included === 'total'">
                                    <t t-esc="env.pos.format_currency_no_symbol(line.price_with_tax_before_discount)"/>
                                </t>
                                <t t-else="">
                                    <t t-esc="env.pos.format_currency_no_symbol(line.price)"/>
                                </t>
                            </div>
                        </t>
                    <t t-if="line.discount !== 0">
                            <div class="pos-receipt-left-padding">
                                Discount: <t t-esc="line.discount"/>%
                            </div>
                        </t>
                    <div class="pos-receipt-left-padding">
                            <t t-esc="Math.round(line.quantity * Math.pow(10, env.pos.dp['Product Unit of Measure'])) / Math.pow(10, env.pos.dp['Product Unit of Measure'])"/>
                        &#160;
                        <t t-if="!line.is_in_unit" t-esc="line.unit_name"/>
                        x
                        <t t-esc="env.pos.format_currency_no_symbol(line.price_display_one)"/>
                        <span class="price_display pos-receipt-right-align">
                                <t t-esc="env.pos.format_currency_no_symbol(line.price_display)"/>
                            </span>
                        </div>
                    <!--</t>-->
                    <t t-if="line.pack_lot_lines">
                        <div class="pos-receipt-left-padding">
                            <ul>
                                <t t-foreach="line.pack_lot_lines" t-as="lot" t-key="lot.cid">
                                    <li>
                                        SN <t t-esc="lot.attributes['lot_name']"/>
                                    </li>
                                </t>
                            </ul>
                        </div>
                    </t>
                </t>
            </div>
        </xpath>

    </t>

    <t t-name="ProductItem" t-inherit="point_of_sale.ProductItem" t-inherit-mode="extension" owl="1">
        <xpath expr="//div[hasclass('product-name')]" position="replace">
            <style>

                .cut-text {
                    overflow: hidden;
                    position: relative;
                    line-height: 1.2em;
                    max-height: 2.4em;
                    text-align: justify;
                    margin-right: -1em;
                    padding-right: 1em;
                }

                /*
                .cut-text:before {
                    content: ' ...';
                    position: absolute;
                    right: 0;
                    bottom: 0;
                }
                */
                .cut-text:after {
                    content: '';
                    position: absolute;
                    right: 0;
                    width: 1em;
                    height: 1em;
                    margin-top: 0.2em;
                    background: white;
                }

                /*
                .cut-text {
                    text-overflow: ellipsis;
                    overflow: hidden;
                    width: 60px;
                    height: 2.5em;
                    white-space: nowrap;
                    top: 98px;
                }

                .cut-text:hover:after{
                    cursor: pointer;
                }
                */

                .tooltip {
                    width: 60%;
                    visibility: hidden;
                    background-color: #fff;
                    padding: 20px;
                    -webkit-box-shadow: 0 0 50px 0 rgba(0,0,0,0.3);
                    opacity: 0;
                    transition: opacity 0.5s ease;
                }
                .cut-text:hover + .tooltip{
                    visibility: visible;
                    transition: opacity 0.5s ease;
                    opacity: 1;
                }
            </style>
            <div class="product-name cut-text" style="padding-top: 1px;"
                 t-attf-id="article_product_{{props.product.id}}">
<!--                <t t-esc="props.product.short_name"/>-->
                <t t-esc="props.product.display_name"/>
            </div>

            <div class="product-name tooltip" style="padding-top: 1px;"
                 t-attf-id="article_product_{{props.product.id}}">
<!--                <t t-esc="props.product.short_name"/>-->
                <t t-esc="props.product.display_name"/>
            </div>
        </xpath>
    </t>

    <t t-name="WrappedProductNameLines" t-inherit="point_of_sale.WrappedProductNameLines" t-inherit-mode="extension"
       owl="1">
        <xpath expr="//t[@t-as='wrapped_line']" position="replace">
            <t t-foreach="props.line.product_name_wrapped.slice(1,2)" t-as="wrapped_line"><t t-esc="wrapped_line"/></t>
        </xpath>
    </t>

    <t t-name="OrderSummary" t-inherit="point_of_sale.OrderSummary" t-inherit-mode="extension" owl="1">
        <xpath expr="//div[@class='entry total']" position="after">
            <div class="subentry">
                Puntos:
                <span class="value" t-esc="puntos"/>
            </div>
        </xpath>
    </t>

    <t t-name="ProductsWidgetControlPanel" t-inherit="point_of_sale.ProductsWidgetControlPanel"
       t-inherit-mode="extension" owl="1">
        <xpath expr="//div[@class='products-widget-control']" position="attributes">
            <attribute name="style">overflow: auto;max-height: 240px;min-height: 60px;</attribute>
        </xpath>
    </t>

</templates>

